{% extends "layout.html" %}

{% block content %}
<div class="col-md-9 pad-right">
    <div class="card">
        <div class="card-header">
            抽奖信息配置
        </div>
        <div class="card-body">
            <form id="form-data">
                <div class="form-group">
                    <label>一等奖人数 : {{ data['num1'] }}</label>
                </div>
                <div class="form-group">
                    <label>二等奖人数 : {{ data['num2'] }}</label>
                </div>
                <div class="form-group">
                    <label>三等奖人数 : {{ data['num3'] }}</label>
                </div>
                <div class="form-group">
                    <label>总获奖人数 : {{ data['win_len'] }}
                        &nbsp;
                        总人数 : {{ data['people_len'] }}</label>
                </div>
            </form>
        </div>
    </div>
    <div class="card">
        <div class="card-header">
            抽奖结果
        </div>
        <div class="card-body">
            <form id="form-data" enctype="multipart/form-data" method="post">
                <div class="form-group">
                    <label>一等奖</label>
                    <div id = "p1" style='font-size:20px; color:red'>

                    </div>
                </div>
                <div class="form-group">
                    <label>二等奖</label>
                    <div id = "p2" style='font-size:20px; color:blue'>

                    </div>
                </div>
                <div class="form-group">
                    <label>三等奖</label>
                    <div id = "p3" style='font-size:20px; color:green'>

                    </div>
                </div>
                <div class="form-group">
                    <a class="btn btn-primary"
                    onclick="start()" style="color: aliceblue;">开始抽奖</a>
                    &nbsp;
                    <a class="btn btn-primary"
                    onclick="stop()" style="color: aliceblue;">停止抽奖</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% end %}

{% block foot %}
<script>
    var nam1="{{data['people1']}}".split(",");//参与者名单
    var nam2="{{data['people2']}}".split(",");//参与者名单
    var nam3="{{data['people3']}}".split(",");//参与者名单
    var nameArray="{{data['people_in']}}".split(",");//参与者名单
    var whoGetTheMysteryAward=[];
    var w1='', w2='', w3='';
    var timer1, timer2, timer3, flag;
    function start(){
        creatNameForAward();
    }
    function creatNameForAward(){
        flag=1;
        timer1 = setInterval(function(){
            document.getElementById('p1').innerText= getNameForAward(nam1.length);
        },50);
        timer2 = setInterval(function(){
            document.getElementById('p2').innerText= getNameForAward(nam2.length);
        },50);
        timer3 = setInterval(function(){
            document.getElementById('p3').innerText= getNameForAward(nam3.length);
        },50);
    }

    //停止滚动方法
    function stop(){

        clearInterval(timer1);
        clearInterval(timer2);
        clearInterval(timer3);
        document.getElementById('p1').innerText=ff(nam1);
        document.getElementById('p2').innerText=ff(nam2);
        document.getElementById('p3').innerText=ff(nam3);
        flag++;
        return null;
    }

    function getNameForAward(x){
        var ans = "";
        for (var i = 0;i < x;i++){
            var num = Math.floor(Math.random()*(nameArray.length-1));
            ans += nameArray[num]+"  ";
        }
        return ans;
    }

    function ff(x){
        var ans = "";
        for (var i = 0;i < x.length;i++){
            ans += x[num]+"  ";
        }
        return ans;
    }

</script>
{% end %}